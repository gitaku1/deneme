import os
import time
from huggingface_hub import snapshot_download
from huggingface_hub.utils import HfHubHTTPError

# ======================
# Ortam deÄŸiÅŸkenleri
# ======================
os.environ["HF_HUB_ENABLE_HF_TRANSFER"] = "1"   # hÄ±z & resume iÃ§in Ã¶nerilir
os.environ["HF_HOME"] = "/data01/huggingface"   # cache yolu (isteÄŸe baÄŸlÄ±)

# ======================
# Ayarlar
# ======================
MODEL_ID = "model_sahibi/model_adi"
LOCAL_DIR = "/data01/models/model_adi"
RETRY_WAIT_SECONDS = 60   # hata alÄ±nca kaÃ§ sn beklesin

print(f"ğŸš€ Model indirme baÅŸlÄ±yor: {MODEL_ID}")

while True:
    try:
        snapshot_download(
            repo_id=MODEL_ID,
            local_dir=LOCAL_DIR,
            local_dir_use_symlinks=False,
            resume_download=True,
        )

        print("âœ… Model baÅŸarÄ±yla indirildi.")
        break  # her ÅŸey bittiyse Ã§Ä±k

    except HfHubHTTPError as e:
        print("âš ï¸ HF Hub HTTP hatasÄ± alÄ±ndÄ±:")
        print(e)
        print(f"ğŸ” {RETRY_WAIT_SECONDS} saniye sonra tekrar denenecek...")
        time.sleep(RETRY_WAIT_SECONDS)

    except Exception as e:
        print("âš ï¸ Beklenmeyen bir hata alÄ±ndÄ±:")
        print(e)
        print(f"ğŸ” {RETRY_WAIT_SECONDS} saniye sonra tekrar denenecek...")
        time.sleep(RETRY_WAIT_SECONDS)
