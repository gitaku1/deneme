# AlmaLinux 8 tabanlı bir imaj kullanıyoruz
FROM almalinux:8

# Proxy ayarlarını yapılandırıyoruz
ENV http_proxy=http://hostname:8080
ENV https_proxy=http://hostname:8080

# Gerekli sistem bağımlılıklarını yüklüyoruz
RUN dnf -y update && \
    dnf -y install \
    epel-release \
    gcc \
    gcc-c++ \
    gcc-gfortran \
    make \
    wget \
    curl \
    git \
    vim \
    tar \
    gzip \
    bzip2 \
    xz \
    pcre2 \
    pcre2-devel \
    libcurl-devel \
    libpng-devel \
    libjpeg-turbo-devel \
    libtiff-devel \
    cairo-devel \
    pango-devel \
    freetype-devel \
    texinfo-devel \
    texlive-scheme-basic \
    zlib-devel \
    bzip2-devel \
    xz-devel \
    readline-devel \
    ncurses-devel \
    openssl-devel \
    libssh2-devel \
    sqlite-devel \
    libuuid-devel \
    tcl-devel \
    tk-devel \
    java-1.8.0-openjdk-devel && \
    dnf clean all

# R 4.5.1'i kaynak koddan indirip kuruyoruz
RUN wget https://cran.r-project.org/src/base/R-4/R-4.5.1.tar.gz && \
    tar -xzf R-4.5.1.tar.gz && \
    cd R-4.5.1 && \
    ./configure --enable-R-shlib --with-x=yes --with-cairo --with-libpng --with-jpeglib && \
    make -j$(nproc) && \
    make install && \
    cd .. && \
    rm -rf R-4.5.1 R-4.5.1.tar.gz

# R'nin doğru kurulduğunu kontrol ediyoruz
RUN R --version
